<dom-module id="paper-tex-button">
  <template>
    <style include="base-styles button-styles">
      :host {
        display: inline-block;
      }

      paper-button {
        display: flex;
        position: relative;
        vertical-align: middle;
        font-size: 16px;
        width: 50px;
        height: 50px;
        min-width: 0;
        min-height: 0;
        padding: 0;
        margin: 0;
      }
    </style>

    <paper-button on-mousedown="_preventDefault" on-tap="_fireTap" raised>
      <div inner-h-t-m-l="[[_texToSvg(code)]]"></div>
    </paper-button>
  </template>

  <script>
    'use strict'

    Polymer({

      is: 'paper-tex-button',

      properties: {
        code: {
          type: String
        }
      },

      attached: function() {
        window.paperTexButton = this
      },

      _texToSvg: function(code) {
        const html = MathJax.tex2svg(code, {
          em: 10,
          ex: 5,
          display: true
        })

        return html.childNodes[0].outerHTML
      },

      _fireTap: function(e) {
        this.fire('code-tap', this.code)

        e.stopPropagation()
        e.stopImmediatePropagation()
      },

      _preventDefault: function(e) {
        e.preventDefault()
      }
    })
  </script>
</dom-module>
